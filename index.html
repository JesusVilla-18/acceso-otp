<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>Acceso con c√≥digo</title>
<style>
body { font-family: Arial; margin:40px; }
input, button { display:block; margin:10px 0; padding:8px; }
#mensaje { margin-top:20px; background:#f2f2f2; padding:10px; border:1px solid #ccc; white-space: pre-line;}
#link { margin-top:10px; }
</style>
</head>
<body>

<h2>Acceso con c√≥digo por correo</h2>

<input id="email" placeholder="Escribe tu correo">
<button onclick="enviarCodigo()">Enviar c√≥digo</button>

<br>

<input id="codigo" placeholder="Escribe el c√≥digo recibido">
<button onclick="verificarCodigo()">Verificar</button>

<p id="mensaje"></p>
<div id="link"></div>

<script>
const APPS_SCRIPT_URL = "https://script.google.com/macros/s/AKfycbwkaCdUIsgbgGE6RAQxOnHUDPhtWH4UuULOZdXxcUamzofQISkypgLx5v1yxVpUiF8MLw/exec";

function log(msg){ document.getElementById("mensaje").innerText += "\n" + msg; }

function enviarCodigo(){
  const email = document.getElementById("email").value.trim();
  document.getElementById("mensaje").innerText = "";
  document.getElementById("link").innerHTML = "";

  if(!email){ log("‚ùå Escribe un correo"); return; }

  log("üì§ Enviando c√≥digo por correo...");

  const script = document.createElement("script");
  script.src = `${APPS_SCRIPT_URL}?email=${encodeURIComponent(email)}&callback=callbackEnviar`;
  document.body.appendChild(script);
}

function callbackEnviar(data){
  if(data.ok){
    log("‚úÖ " + data.mensaje);
  }else{
    log("‚ùå " + data.mensaje);
  }
}

function verificarCodigo(){
  const email = document.getElementById("email").value.trim();
  const codigo = document.getElementById("codigo").value.trim();
  document.getElementById("link").innerHTML = "";

  if(!email || !codigo){ log("‚ùå Llena ambos campos"); return; }

  const script = document.createElement("script");
  script.src = `${APPS_SCRIPT_URL}?email=${encodeURIComponent(email)}&codigo=${encodeURIComponent(codigo)}&callback=callbackVerificar`;
  document.body.appendChild(script);
}

function callbackVerificar(data){
  if(data.ok){
    document.getElementById("link").innerHTML = 'üîó Tu link: <a href="'+data.link+'" target="_blank">'+data.link+'</a>';
    log("‚úÖ C√≥digo correcto");
  }else{
    log("‚ùå " + data.mensaje);
  }
}
</script>

</body>
</html>
