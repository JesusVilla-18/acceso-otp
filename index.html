<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>Acceso con correo OTP</title>
<style>
body{font-family:Arial;margin:40px;}
input,button{display:block;margin:10px 0;padding:8px;}
#mensaje{margin-top:20px;white-space:pre-line;border:1px solid #ccc;padding:10px;background:#f2f2f2;}
a{color:blue;}
</style>
</head>
<body>

<h2>Acceso con correo</h2>
<input id="email" placeholder="Escribe tu correo">
<button onclick="enviarCodigo()">Enviar c√≥digo</button>

<br>
<input id="codigo" placeholder="Escribe el c√≥digo recibido">
<button onclick="verificarCodigo()">Verificar</button>

<p id="mensaje"></p>

<script>
const APPS_SCRIPT_URL = "https://script.google.com/macros/s/AKfycbxPuaZUnsgZpL9dFyLPtM4ZqeF_XKA1zGHZf3EMkTMdkAINgEA0PZofYGNYqtXX-3t-mw/exec";

function log(msg){document.getElementById("mensaje").innerText += msg+"\n";}

function enviarCodigo(){
  document.getElementById("mensaje").innerText = "";
  const email = document.getElementById("email").value.trim();
  if(!email){log("‚ùå Ingresa un correo");return;}

  log("üì§ Enviando c√≥digo por correo...");
  const script = document.createElement("script");
  script.src = `${APPS_SCRIPT_URL}?email=${encodeURIComponent(email)}&callback=callbackEnviar`;
  document.body.appendChild(script);
}

function callbackEnviar(data){
  if(data.ok){
    log("‚úÖ " + data.mensaje);
  } else {
    log("‚ùå " + data.mensaje);
  }
}

function verificarCodigo(){
  const email = document.getElementById("email").value.trim();
  const codigo = document.getElementById("codigo").value.trim();
  if(!email || !codigo){ log("‚ùå Ingresa correo y c√≥digo"); return; }

  const script = document.createElement("script");
  script.src = `${APPS_SCRIPT_URL}?email=${encodeURIComponent(email)}&codigo=${encodeURIComponent(codigo)}&callback=callbackVerificar`;
  document.body.appendChild(script);
}

function callbackVerificar(data){
  if(data.ok){
    log("‚úÖ C√≥digo correcto!");
    document.getElementById("mensaje").innerHTML += `<br>üîó Link: <a href="${data.link}" target="_blank">${data.link}</a>`;
  } else {
    log("‚ùå " + data.mensaje);
  }
}
</script>

</body>
</html>
